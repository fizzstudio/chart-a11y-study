var __spreadArray=this&&this.__spreadArray||function(t,e,i){if(i||arguments.length===2)for(var s=0,a=e.length,r;s<a;s++){if(r||!(s in e)){if(!r)r=Array.prototype.slice.call(e,0,s);r[s]=e[s]}}return t.concat(r||Array.prototype.slice.call(e))};import{r as registerInstance,c as createEvent,h,g as getElement}from"./index-1c5d8972.js";import{v as visaChartsUtils_umd,s as select,e as event}from"./visa-charts-utils.umd-23a648ee.js";import{m as max}from"./max-d011e4a4.js";import{v as v4}from"./index-ba4ad12d.js";var propDefaultValues=visaChartsUtils_umd.propDefaultValues;var CirclePackingDefaultValues=function(){function t(){}return t}();CirclePackingDefaultValues.mainTitle="Circle Packing Title";CirclePackingDefaultValues.subTitle="This is the circle packing chart's subtitle";CirclePackingDefaultValues.height=400;CirclePackingDefaultValues.width=400;CirclePackingDefaultValues.circlePadding=5;CirclePackingDefaultValues.margin={top:400*.01,bottom:400*.01,right:400*.01,left:400*.01};CirclePackingDefaultValues.padding={top:400*.01,bottom:400*.01,right:400*.01,left:400*.01};CirclePackingDefaultValues.dataDepth=5;CirclePackingDefaultValues.displayDepth=2;CirclePackingDefaultValues.parentAccessor="parentNode";CirclePackingDefaultValues.nodeAccessor="childNode";CirclePackingDefaultValues.sizeAccessor="value";CirclePackingDefaultValues.colorPalette=propDefaultValues.colorPaletteSequentialGrey;CirclePackingDefaultValues.dataLabel=propDefaultValues.dataLabelCenter;CirclePackingDefaultValues.hoverStyle=propDefaultValues.hoverStyle;CirclePackingDefaultValues.clickStyle=propDefaultValues.clickStyle;CirclePackingDefaultValues.hoverOpacity=propDefaultValues.hoverOpacity;CirclePackingDefaultValues.cursor=propDefaultValues.cursor;CirclePackingDefaultValues.interactionKeys=propDefaultValues.interactionKeys;CirclePackingDefaultValues.highestHeadingLevel=propDefaultValues.highestHeadingLevel;CirclePackingDefaultValues.annotations=propDefaultValues.annotations;CirclePackingDefaultValues.accessibility=propDefaultValues.accessibility;CirclePackingDefaultValues.animationConfig=propDefaultValues.animationConfig;CirclePackingDefaultValues.tooltipLabel=propDefaultValues.tooltipLabel;CirclePackingDefaultValues.showTooltip=propDefaultValues.showTooltip;CirclePackingDefaultValues.clickHighlight=propDefaultValues.clickHighlight;CirclePackingDefaultValues.suppressEvents=propDefaultValues.suppressEvents;function count(t){var e=0,i=t.children,s=i&&i.length;if(!s)e=1;else while(--s>=0)e+=i[s].value;t.value=e}function node_count(){return this.eachAfter(count)}function node_each(t){var e=this,i,s=[e],a,r,o;do{i=s.reverse(),s=[];while(e=i.pop()){t(e),a=e.children;if(a)for(r=0,o=a.length;r<o;++r){s.push(a[r])}}}while(s.length);return this}function node_eachBefore(t){var e=this,i=[e],s,a;while(e=i.pop()){t(e),s=e.children;if(s)for(a=s.length-1;a>=0;--a){i.push(s[a])}}return this}function node_eachAfter(t){var e=this,i=[e],s=[],a,r,o;while(e=i.pop()){s.push(e),a=e.children;if(a)for(r=0,o=a.length;r<o;++r){i.push(a[r])}}while(e=s.pop()){t(e)}return this}function node_sum(t){return this.eachAfter((function(e){var i=+t(e.data)||0,s=e.children,a=s&&s.length;while(--a>=0)i+=s[a].value;e.value=i}))}function node_sort(t){return this.eachBefore((function(e){if(e.children){e.children.sort(t)}}))}function node_path(t){var e=this,i=leastCommonAncestor(e,t),s=[e];while(e!==i){e=e.parent;s.push(e)}var a=s.length;while(t!==i){s.splice(a,0,t);t=t.parent}return s}function leastCommonAncestor(t,e){if(t===e)return t;var i=t.ancestors(),s=e.ancestors(),a=null;t=i.pop();e=s.pop();while(t===e){a=t;t=i.pop();e=s.pop()}return a}function node_ancestors(){var t=this,e=[t];while(t=t.parent){e.push(t)}return e}function node_descendants(){var t=[];this.each((function(e){t.push(e)}));return t}function node_leaves(){var t=[];this.eachBefore((function(e){if(!e.children){t.push(e)}}));return t}function node_links(){var t=this,e=[];t.each((function(i){if(i!==t){e.push({source:i.parent,target:i})}}));return e}function hierarchy(t,e){var i=new Node$1(t),s=+t.value&&(i.value=t.value),a,r=[i],o,n,l,c;if(e==null)e=defaultChildren;while(a=r.pop()){if(s)a.value=+a.data.value;if((n=e(a.data))&&(c=n.length)){a.children=new Array(c);for(l=c-1;l>=0;--l){r.push(o=a.children[l]=new Node$1(n[l]));o.parent=a;o.depth=a.depth+1}}}return i.eachBefore(computeHeight)}function node_copy(){return hierarchy(this).eachBefore(copyData)}function defaultChildren(t){return t.children}function copyData(t){t.data=t.data.data}function computeHeight(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function Node$1(t){this.data=t;this.depth=this.height=0;this.parent=null}Node$1.prototype=hierarchy.prototype={constructor:Node$1,count:node_count,each:node_each,eachAfter:node_eachAfter,eachBefore:node_eachBefore,sum:node_sum,sort:node_sort,path:node_path,ancestors:node_ancestors,descendants:node_descendants,leaves:node_leaves,links:node_links,copy:node_copy};var slice=Array.prototype.slice;function shuffle(t){var e=t.length,i,s;while(e){s=Math.random()*e--|0;i=t[e];t[e]=t[s];t[s]=i}return t}function enclose(t){var e=0,i=(t=shuffle(slice.call(t))).length,s=[],a,r;while(e<i){a=t[e];if(r&&enclosesWeak(r,a))++e;else r=encloseBasis(s=extendBasis(s,a)),e=0}return r}function extendBasis(t,e){var i,s;if(enclosesWeakAll(e,t))return[e];for(i=0;i<t.length;++i){if(enclosesNot(e,t[i])&&enclosesWeakAll(encloseBasis2(t[i],e),t)){return[t[i],e]}}for(i=0;i<t.length-1;++i){for(s=i+1;s<t.length;++s){if(enclosesNot(encloseBasis2(t[i],t[s]),e)&&enclosesNot(encloseBasis2(t[i],e),t[s])&&enclosesNot(encloseBasis2(t[s],e),t[i])&&enclosesWeakAll(encloseBasis3(t[i],t[s],e),t)){return[t[i],t[s],e]}}}throw new Error}function enclosesNot(t,e){var i=t.r-e.r,s=e.x-t.x,a=e.y-t.y;return i<0||i*i<s*s+a*a}function enclosesWeak(t,e){var i=t.r-e.r+1e-6,s=e.x-t.x,a=e.y-t.y;return i>0&&i*i>s*s+a*a}function enclosesWeakAll(t,e){for(var i=0;i<e.length;++i){if(!enclosesWeak(t,e[i])){return false}}return true}function encloseBasis(t){switch(t.length){case 1:return encloseBasis1(t[0]);case 2:return encloseBasis2(t[0],t[1]);case 3:return encloseBasis3(t[0],t[1],t[2])}}function encloseBasis1(t){return{x:t.x,y:t.y,r:t.r}}function encloseBasis2(t,e){var i=t.x,s=t.y,a=t.r,r=e.x,o=e.y,n=e.r,l=r-i,c=o-s,h=n-a,u=Math.sqrt(l*l+c*c);return{x:(i+r+l/u*h)/2,y:(s+o+c/u*h)/2,r:(u+a+n)/2}}function encloseBasis3(t,e,i){var s=t.x,a=t.y,r=t.r,o=e.x,n=e.y,l=e.r,c=i.x,h=i.y,u=i.r,d=s-o,p=s-c,f=a-n,y=a-h,v=l-r,g=u-r,m=s*s+a*a-r*r,b=m-o*o-n*n+l*l,C=m-c*c-h*h+u*u,S=p*f-d*y,A=(f*C-y*b)/(S*2)-s,D=(y*v-f*g)/S,k=(p*b-d*C)/(S*2)-a,x=(d*g-p*v)/S,T=D*D+x*x-1,w=2*(r+A*D+k*x),P=A*A+k*k-r*r,E=-(T?(w+Math.sqrt(w*w-4*T*P))/(2*T):P/w);return{x:s+A+D*E,y:a+k+x*E,r:E}}function place(t,e,i){var s=t.x-e.x,a,r,o=t.y-e.y,n,l,c=s*s+o*o;if(c){r=e.r+i.r,r*=r;l=t.r+i.r,l*=l;if(r>l){a=(c+l-r)/(2*c);n=Math.sqrt(Math.max(0,l/c-a*a));i.x=t.x-a*s-n*o;i.y=t.y-a*o+n*s}else{a=(c+r-l)/(2*c);n=Math.sqrt(Math.max(0,r/c-a*a));i.x=e.x+a*s-n*o;i.y=e.y+a*o+n*s}}else{i.x=e.x+i.r;i.y=e.y}}function intersects(t,e){var i=t.r+e.r-1e-6,s=e.x-t.x,a=e.y-t.y;return i>0&&i*i>s*s+a*a}function score(t){var e=t._,i=t.next._,s=e.r+i.r,a=(e.x*i.r+i.x*e.r)/s,r=(e.y*i.r+i.y*e.r)/s;return a*a+r*r}function Node(t){this._=t;this.next=null;this.previous=null}function packEnclose(t){if(!(a=t.length))return 0;var e,i,s,a,r,o,n,l,c,h,u;e=t[0],e.x=0,e.y=0;if(!(a>1))return e.r;i=t[1],e.x=-i.r,i.x=e.r,i.y=0;if(!(a>2))return e.r+i.r;place(i,e,s=t[2]);e=new Node(e),i=new Node(i),s=new Node(s);e.next=s.previous=i;i.next=e.previous=s;s.next=i.previous=e;t:for(n=3;n<a;++n){place(e._,i._,s=t[n]),s=new Node(s);l=i.next,c=e.previous,h=i._.r,u=e._.r;do{if(h<=u){if(intersects(l._,s._)){i=l,e.next=i,i.previous=e,--n;continue t}h+=l._.r,l=l.next}else{if(intersects(c._,s._)){e=c,e.next=i,i.previous=e,--n;continue t}u+=c._.r,c=c.previous}}while(l!==c.next);s.previous=e,s.next=i,e.next=i.previous=i=s;r=score(e);while((s=s.next)!==i){if((o=score(s))<r){e=s,r=o}}i=e.next}e=[i._],s=i;while((s=s.next)!==i)e.push(s._);s=enclose(e);for(n=0;n<a;++n)e=t[n],e.x-=s.x,e.y-=s.y;return s.r}function optional(t){return t==null?null:required(t)}function required(t){if(typeof t!=="function")throw new Error;return t}function constantZero(){return 0}function constant(t){return function(){return t}}function defaultRadius(t){return Math.sqrt(t.value)}function index(){var t=null,e=1,i=1,s=constantZero;function a(a){a.x=e/2,a.y=i/2;if(t){a.eachBefore(radiusLeaf(t)).eachAfter(packChildren(s,.5)).eachBefore(translateChild(1))}else{a.eachBefore(radiusLeaf(defaultRadius)).eachAfter(packChildren(constantZero,1)).eachAfter(packChildren(s,a.r/Math.min(e,i))).eachBefore(translateChild(Math.min(e,i)/(2*a.r)))}return a}a.radius=function(e){return arguments.length?(t=optional(e),a):t};a.size=function(t){return arguments.length?(e=+t[0],i=+t[1],a):[e,i]};a.padding=function(t){return arguments.length?(s=typeof t==="function"?t:constant(+t),a):s};return a}function radiusLeaf(t){return function(e){if(!e.children){e.r=Math.max(0,+t(e)||0)}}}function packChildren(t,e){return function(i){if(s=i.children){var s,a,r=s.length,o=t(i)*e||0,n;if(o)for(a=0;a<r;++a)s[a].r+=o;n=packEnclose(s);if(o)for(a=0;a<r;++a)s[a].r-=o;i.r=n+o}}}function translateChild(t){return function(e){var i=e.parent;e.r*=t;if(i){e.x=i.x+t*e.x;e.y=i.y+t*e.y}}}var keyPrefix="$",preroot={depth:-1},ambiguous={};function defaultId(t){return t.id}function defaultParentId(t){return t.parentId}function stratify(){var t=defaultId,e=defaultParentId;function i(i){var s,a,r=i.length,o,n,l,c=new Array(r),h,u,d={};for(a=0;a<r;++a){s=i[a],l=c[a]=new Node$1(s);if((h=t(s,a,i))!=null&&(h+="")){u=keyPrefix+(l.id=h);d[u]=u in d?ambiguous:l}}for(a=0;a<r;++a){l=c[a],h=e(i[a],a,i);if(h==null||!(h+="")){if(o)throw new Error("multiple roots");o=l}else{n=d[keyPrefix+h];if(!n)throw new Error("missing: "+h);if(n===ambiguous)throw new Error("ambiguous: "+h);if(n.children)n.children.push(l);else n.children=[l];l.parent=n}}if(!o)throw new Error("no root");o.parent=preroot;o.eachBefore((function(t){t.depth=t.parent.depth+1;--r})).eachBefore(computeHeight);o.parent=null;if(r>0)throw new Error("cycle");return o}i.id=function(e){return arguments.length?(t=required(e),i):t};i.parentId=function(t){return arguments.length?(e=required(t),i):e};return i}var circlePackingCss='.o-layout{width:100%;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.o-layout--chart{width:100%}.is--vertical .o-layout--chart{width:90%}circle-packing .screen-reader-info{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}circle-packing .annotations{pointer-events:none}circle-packing .annotations .handle{pointer-events:all}circle-packing .label{font:12px "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;text-anchor:middle}circle-packing .label,circle-packing .node--root{pointer-events:none}';var getContrastingStroke=visaChartsUtils_umd.getContrastingStroke,createTextStrokeFilter=visaChartsUtils_umd.createTextStrokeFilter,convertColorsToTextures=visaChartsUtils_umd.convertColorsToTextures,initializeElementAccess=visaChartsUtils_umd.initializeElementAccess,initializeDescriptionRoot=visaChartsUtils_umd.initializeDescriptionRoot,setElementFocusHandler=visaChartsUtils_umd.setElementFocusHandler,setElementAccessID=visaChartsUtils_umd.setElementAccessID,setAccessibilityController=visaChartsUtils_umd.setAccessibilityController,hideNonessentialGroups=visaChartsUtils_umd.hideNonessentialGroups,setAccessTitle=visaChartsUtils_umd.setAccessTitle,setAccessSubtitle=visaChartsUtils_umd.setAccessSubtitle,setAccessLongDescription=visaChartsUtils_umd.setAccessLongDescription,setAccessExecutiveSummary=visaChartsUtils_umd.setAccessExecutiveSummary,setAccessPurpose=visaChartsUtils_umd.setAccessPurpose,setAccessContext=visaChartsUtils_umd.setAccessContext,setAccessStatistics=visaChartsUtils_umd.setAccessStatistics,setAccessChartCounts=visaChartsUtils_umd.setAccessChartCounts,setAccessStructure=visaChartsUtils_umd.setAccessStructure,setAccessAnnotation=visaChartsUtils_umd.setAccessAnnotation,retainAccessFocus=visaChartsUtils_umd.retainAccessFocus,checkAccessFocus=visaChartsUtils_umd.checkAccessFocus,setElementInteractionAccessState=visaChartsUtils_umd.setElementInteractionAccessState,drawTooltip=visaChartsUtils_umd.drawTooltip,setAccessibilityDescriptionWidth=visaChartsUtils_umd.setAccessibilityDescriptionWidth,annotate=visaChartsUtils_umd.annotate,getPadding=visaChartsUtils_umd.getPadding,chartAccessors=visaChartsUtils_umd.chartAccessors,checkInteraction=visaChartsUtils_umd.checkInteraction,checkClicked=visaChartsUtils_umd.checkClicked,checkHovered=visaChartsUtils_umd.checkHovered,convertVisaColor=visaChartsUtils_umd.convertVisaColor,getColors=visaChartsUtils_umd.getColors,getLicenses=visaChartsUtils_umd.getLicenses,getScopedData=visaChartsUtils_umd.getScopedData,initTooltipStyle=visaChartsUtils_umd.initTooltipStyle,transitionEndAll=visaChartsUtils_umd.transitionEndAll,overrideTitleTooltip=visaChartsUtils_umd.overrideTitleTooltip,roundTo=visaChartsUtils_umd.roundTo,scopeDataKeys=visaChartsUtils_umd.scopeDataKeys,visaColors=visaChartsUtils_umd.visaColors,validateAccessibilityProps=visaChartsUtils_umd.validateAccessibilityProps,findTagLevel=visaChartsUtils_umd.findTagLevel,prepareRenderChange=visaChartsUtils_umd.prepareRenderChange,resolveLabelCollision=visaChartsUtils_umd.resolveLabelCollision;var CirclePacking=function(){function t(t){var e=this;registerInstance(this,t);this.clickEvent=createEvent(this,"clickEvent",7);this.hoverEvent=createEvent(this,"hoverEvent",7);this.mouseOutEvent=createEvent(this,"mouseOutEvent",7);this.initialLoadEvent=createEvent(this,"initialLoadEvent",7);this.drawStartEvent=createEvent(this,"drawStartEvent",7);this.drawEndEvent=createEvent(this,"drawEndEvent",7);this.transitionEndEvent=createEvent(this,"transitionEndEvent",7);this.mainTitle=CirclePackingDefaultValues.mainTitle;this.subTitle=CirclePackingDefaultValues.subTitle;this.height=CirclePackingDefaultValues.height;this.width=CirclePackingDefaultValues.width;this.margin=CirclePackingDefaultValues.margin;this.padding=CirclePackingDefaultValues.padding;this.circlePadding=CirclePackingDefaultValues.circlePadding;this.highestHeadingLevel=CirclePackingDefaultValues.highestHeadingLevel;this.dataDepth=CirclePackingDefaultValues.dataDepth;this.displayDepth=CirclePackingDefaultValues.displayDepth;this.parentAccessor=CirclePackingDefaultValues.parentAccessor;this.nodeAccessor=CirclePackingDefaultValues.nodeAccessor;this.sizeAccessor=CirclePackingDefaultValues.sizeAccessor;this.colorPalette=CirclePackingDefaultValues.colorPalette;this.cursor=CirclePackingDefaultValues.cursor;this.hoverStyle=CirclePackingDefaultValues.hoverStyle;this.clickStyle=CirclePackingDefaultValues.clickStyle;this.hoverOpacity=CirclePackingDefaultValues.hoverOpacity;this.animationConfig=CirclePackingDefaultValues.animationConfig;this.showTooltip=CirclePackingDefaultValues.showTooltip;this.tooltipLabel=CirclePackingDefaultValues.tooltipLabel;this.dataLabel=CirclePackingDefaultValues.dataLabel;this.annotations=CirclePackingDefaultValues.annotations;this.accessibility=CirclePackingDefaultValues.accessibility;this.suppressEvents=CirclePackingDefaultValues.suppressEvents;this.clickHighlight=CirclePackingDefaultValues.clickHighlight;this.shouldValidateAccessibility=true;this.currentDepth=0;this.zooming=false;this.timer=0;this.delay=200;this.prevent=false;this.updated=false;this.exitSize=0;this.enterSize=0;this.shouldZoom=false;this.shouldValidateInteractionKeys=false;this.shouldDrawInteractionState=false;this.shouldUpdateAnnotations=false;this.shouldResetRoot=false;this.shouldSetColors=false;this.shouldUpdateDisplayDepth=false;this.shouldUpdateLabels=false;this.shouldAddStrokeUnder=false;this.shouldUpdateCursor=false;this.shouldUpdateData=false;this.shouldUpdateTableData=false;this.shouldValidate=false;this.shouldBindInteractivity=false;this.shouldUpdateDescriptionWrapper=false;this.shouldSetChartAccessibilityTitle=false;this.shouldSetChartAccessibilitySubtitle=false;this.shouldSetChartAccessibilityLongDescription=false;this.shouldSetChartAccessibilityExecutiveSummary=false;this.shouldSetChartAccessibilityStatisticalNotes=false;this.shouldSetChartAccessibilityStructureNotes=false;this.shouldSetParentSVGAccessibility=false;this.shouldSetGeometryAccessibilityAttributes=false;this.shouldSetGeometryAriaLabels=false;this.shouldSetGroupAccessibilityAttributes=false;this.shouldSetGroupAccessibilityLabel=false;this.shouldSetChartAccessibilityPurpose=false;this.shouldSetChartAccessibilityContext=false;this.shouldSetChartAccessibilityCount=false;this.shouldUpdateLayout=false;this.shouldSetTextures=false;this.shouldSetStrokes=false;this.shouldSetTextStrokes=false;this.shouldSetTagLevels=false;this.shouldRedrawWrapper=false;this.shouldSetIDs=false;this.innerInteractionKeys=[];this.defaultsLoaded={};this.bottomLevel="p";this.topLevel="h2";this.strokes={};this.setCircleFilter=function(t,i,s){return!select(s[i]).classed("moving")&&!e.accessibility.hideStrokes?e.filter:null};this.setIDs=function(){e.rootG.selectAll("circle:not(.vcl-accessibility-focus-highlight)").attr("id",(function(t){return"circle-in-pack-"+e.generateValidId(t.data.id)}))};this.generateValidId=function(t){var i=t instanceof Date?t.getTime():t;return(i+"-"+e.chartID).replace(/\W/g,"-")};this.setCircleStyle=function(t,i,s){var a=select(s[i].parentNode).datum();var r=a.data.data;var o=e.colorArr[a.depth]||"#fff";var n=checkClicked(r,e.clickHighlight,e.innerInteractionKeys);var l=checkHovered(r,e.hoverHighlight,e.innerInteractionKeys);var c=a.depth!==0?n&&e.clickStyle.color?visaColors[e.clickStyle.color]||e.clickStyle.color||o:l&&e.hoverStyle.color?visaColors[e.hoverStyle.color]||e.hoverStyle.color||o:o:o;select(s[i]).attr("stroke",n?getContrastingStroke(visaColors[e.clickStyle.color]||e.clickStyle.color||e.preparedColors[a.depth]):l?getContrastingStroke(visaColors[e.hoverStyle.color]||e.hoverStyle.color||e.preparedColors[a.depth]):e.strokes[a.depth]).attr("stroke-width",n?e.clickStyle.strokeWidth||3:l?e.hoverStyle.strokeWidth||2:!e.accessibility.hideStrokes?1:0).attr("stroke-dasharray",l&&!n?"4 3":"");return c}}t.prototype.dataWatcher=function(t,e){this.updated=true;this.shouldUpdateData=true;this.shouldUpdateTableData=true;this.shouldValidate=true;this.shouldZoom=true;this.shouldAddStrokeUnder=true;this.shouldSetGeometryAccessibilityAttributes=true;this.shouldSetGeometryAriaLabels=true;this.shouldDrawInteractionState=true;this.shouldSetTextures=true;this.shouldSetStrokes=true;this.shouldSetColors=true};t.prototype.titleWatcher=function(t,e){this.shouldValidate=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetParentSVGAccessibility=true};t.prototype.subtitleWatcher=function(t,e){this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetParentSVGAccessibility=true};t.prototype.headingWatcher=function(t,e){this.shouldRedrawWrapper=true;this.shouldSetTagLevels=true;this.shouldSetChartAccessibilityCount=true;this.shouldUpdateDescriptionWrapper=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetChartAccessibilityLongDescription=true;this.shouldSetChartAccessibilityContext=true;this.shouldSetChartAccessibilityExecutiveSummary=true;this.shouldSetChartAccessibilityPurpose=true;this.shouldSetChartAccessibilityStatisticalNotes=true;this.shouldSetChartAccessibilityStructureNotes=true};t.prototype.clusterWatcher=function(t,e){this.shouldUpdateData=true;this.shouldUpdateTableData=true;this.shouldZoom=true;this.shouldAddStrokeUnder=true;this.shouldSetGeometryAriaLabels=true;this.shouldDrawInteractionState=true};t.prototype.nodeWatcher=function(t,e){this.shouldUpdateData=true;this.shouldUpdateTableData=true;this.shouldZoom=true;this.shouldAddStrokeUnder=true;this.shouldSetGeometryAriaLabels=true;this.shouldDrawInteractionState=true};t.prototype.sizeWatcher=function(t,e){this.shouldUpdateData=true;this.shouldUpdateTableData=true;this.shouldSetGeometryAriaLabels=true;this.shouldZoom=true};t.prototype.heightWatcher=function(t,e){this.shouldUpdateLayout=true;this.shouldResetRoot=true;this.shouldUpdateData=true;this.shouldZoom=true;this.shouldAddStrokeUnder=true};t.prototype.dataDepthWatcher=function(t,e){this.shouldUpdateData=true;this.shouldSetColors=true;this.shouldZoom=true};t.prototype.displayDepthWatcher=function(t,e){this.shouldUpdateDisplayDepth=true;this.shouldZoom=true};t.prototype.circlePaddingWatcher=function(t,e){this.shouldUpdateData=true;this.shouldZoom=true};t.prototype.colorsWatcher=function(t,e){this.shouldSetColors=true;this.shouldDrawInteractionState=true;this.shouldSetTextures=true;this.shouldSetStrokes=true};t.prototype.showTooltipWatcher=function(t,e){this.shouldDrawInteractionState=true};t.prototype.tooltipLabelWatcher=function(t,e){this.shouldUpdateTableData=true};t.prototype.hoverOpacityWatcher=function(t,e){this.shouldDrawInteractionState=true};t.prototype.interactionStyleWatcher=function(t,e){this.shouldDrawInteractionState=true;this.shouldSetTextures=true;this.shouldSetStrokes=true;this.shouldSetColors=true};t.prototype.cursorWatcher=function(t,e){this.shouldUpdateCursor=true};t.prototype.clickWatcher=function(t,e){this.shouldDrawInteractionState=true};t.prototype.hoverWatcher=function(t,e){this.shouldDrawInteractionState=true};t.prototype.zoomWatcher=function(t,e){this.shouldZoom=true};t.prototype.interactionWatcher=function(t,e){this.shouldValidateInteractionKeys=true;this.shouldUpdateTableData=true;this.shouldDrawInteractionState=true;this.shouldSetGeometryAriaLabels=true};t.prototype.labelWatcher=function(t,e){this.shouldUpdateTableData=true;this.shouldUpdateLabels=true;this.shouldAddStrokeUnder=true};t.prototype.accessibilityWatcher=function(t,e){this.shouldValidate=true;var i=t&&t.title?t.title:false;var s=e&&e.title?e.title:false;if(i!==s){this.shouldUpdateDescriptionWrapper=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetParentSVGAccessibility=true}var a=t&&t.executiveSummary?t.executiveSummary:false;var r=e&&e.executiveSummary?e.executiveSummary:false;if(a!==r){this.shouldSetChartAccessibilityExecutiveSummary=true}var o=t&&t.purpose?t.purpose:false;var n=e&&e.purpose?e.purpose:false;if(o!==n){this.shouldSetChartAccessibilityPurpose=true}var l=t&&t.longDescription?t.longDescription:false;var c=e&&e.longDescription?e.longDescription:false;if(l!==c){this.shouldSetChartAccessibilityLongDescription=true}var h=t&&t.contextExplanation?t.contextExplanation:false;var u=e&&e.contextExplanation?e.contextExplanation:false;if(h!==u){this.shouldSetChartAccessibilityContext=true}var d=t&&t.statisticalNotes?t.statisticalNotes:false;var p=e&&e.statisticalNotes?e.statisticalNotes:false;if(d!==p){this.shouldSetChartAccessibilityStatisticalNotes=true}var f=t&&t.structureNotes?t.structureNotes:false;var y=e&&e.structureNotes?e.structureNotes:false;if(f!==y){this.shouldSetChartAccessibilityStructureNotes=true}var v=t&&t.includeDataKeyNames;var g=e&&e.includeDataKeyNames;var m=t&&t.elementDescriptionAccessor?t.elementDescriptionAccessor:false;var b=e&&e.elementDescriptionAccessor?e.elementDescriptionAccessor:false;if(v!==g||m!==b){if(v!==g){this.shouldSetGroupAccessibilityLabel=true}this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true}var C=t&&t.hideTextures?t.hideTextures:false;var S=e&&e.hideTextures?e.hideTextures:false;if(C!==S){this.shouldSetTextures=true;this.shouldDrawInteractionState=true}var A=t&&t.hideStrokes?t.hideStrokes:false;var D=e&&e.hideStrokes?e.hideStrokes:false;if(A!==D){this.shouldSetStrokes=true;this.shouldDrawInteractionState=true}var k=t&&t.keyboardNavConfig&&t.keyboardNavConfig.disabled?t.keyboardNavConfig.disabled:false;var x=e&&e.keyboardNavConfig&&e.keyboardNavConfig.disabled?e.keyboardNavConfig.disabled:false;var T=t&&t.elementsAreInterface?t.elementsAreInterface:false;var w=e&&e.elementsAreInterface?e.elementsAreInterface:false;if(k!==x||T!==w){this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true;this.shouldUpdateDescriptionWrapper=true;this.shouldRedrawWrapper=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetChartAccessibilityLongDescription=true;this.shouldSetChartAccessibilityContext=true;this.shouldSetChartAccessibilityExecutiveSummary=true;this.shouldSetChartAccessibilityPurpose=true;this.shouldSetChartAccessibilityStatisticalNotes=true;this.shouldSetChartAccessibilityStructureNotes=true}if(T!==w){this.shouldDrawInteractionState=true}};t.prototype.annotationsWatcher=function(t,e){this.shouldValidate=true;this.shouldUpdateAnnotations=true};t.prototype.idWatcher=function(t,e){console.error("Change detected in prop uniqueID from value "+e+" to value "+t+". This prop cannot be changed after component has loaded.")};t.prototype.suppressWatcher=function(t,e){this.shouldBindInteractivity=true;this.shouldUpdateCursor=true;this.shouldSetGeometryAriaLabels=true;this.shouldSetParentSVGAccessibility=true;this.shouldUpdateDescriptionWrapper=true;this.shouldRedrawWrapper=true;this.shouldValidate=true;this.shouldSetChartAccessibilityTitle=true;this.shouldSetChartAccessibilitySubtitle=true;this.shouldSetChartAccessibilityLongDescription=true;this.shouldSetChartAccessibilityContext=true;this.shouldSetChartAccessibilityExecutiveSummary=true;this.shouldSetChartAccessibilityPurpose=true;this.shouldSetChartAccessibilityStatisticalNotes=true;this.shouldSetChartAccessibilityStructureNotes=true};t.prototype.componentWillLoad=function(){var t=this;var e=this.uniqueID||"circle-pack-"+v4();this.initialLoadEvent.emit({chartID:e});return new Promise((function(i){t.duration=0;t.chartID=e;t.circlePackingEl.id=t.chartID;t.setTagLevels();t.validateInteractionKeys();t.setTableData();t.setLayoutData();t.restructureData();t.shouldValidateAccessibilityProps();t.setColors();i("component will load")}))};t.prototype.componentWillUpdate=function(){return new Promise((function(t){t("component will update")}))};t.prototype.componentDidLoad=function(){var t=this;return new Promise((function(e){t.renderRootElements();t.setTooltipInitialStyle();t.setChartDescriptionWrapper();t.setChartAccessibilityTitle();t.setChartAccessibilitySubtitle();t.setChartAccessibilityLongDescription();t.setChartAccessibilityExecutiveSummary();t.setChartAccessibilityPurpose();t.setChartAccessibilityContext();t.setChartAccessibilityStatisticalNotes();t.setChartAccessibilityStructureNotes();t.setParentSVGAccessibility();t.prepareChartForDrawing();t.reSetRoot();t.setTextures();t.setStrokes();t.setTextStrokes();t.updateDisplayDepth();t.enterUpdateExitCircles(t.circleG,t.filterData(t.currentDepth));var i=t.getZoomTarget();t.drawZoomChildren(i);t.setChartCountAccessibility();t.setGeometryAccessibilityAttributes();t.setGeometryAriaLabels();t.addStrokeUnder();t.zoom(i);t.drawAnnotations();t.onChangeHandler();hideNonessentialGroups(t.root.node(),t.circleG.node(),true);e("component did load")}))};t.prototype.componentDidUpdate=function(){var t=this;return new Promise((function(e){t.duration=!t.animationConfig||!t.animationConfig.disabled?750:0;t.prepareChartForDrawing();if(t.shouldResetRoot){t.reSetRoot();t.shouldResetRoot=false}if(t.shouldSetColors){t.setColors();t.shouldSetColors=false}if(t.shouldSetTextures){t.setTextures();t.shouldSetTextures=false}if(t.shouldSetStrokes){t.setStrokes();t.shouldSetStrokes=false}if(t.shouldSetTextStrokes){t.setTextStrokes();t.shouldSetTextStrokes=false}if(t.shouldSetIDs){t.setIDs();t.shouldSetIDs=false}if(t.shouldUpdateDescriptionWrapper){t.setChartDescriptionWrapper();t.shouldUpdateDescriptionWrapper=false}if(t.shouldSetChartAccessibilityCount){t.setChartCountAccessibility();t.shouldSetChartAccessibilityCount=false}if(t.shouldSetChartAccessibilityTitle){t.setChartAccessibilityTitle();t.shouldSetChartAccessibilityTitle=false}if(t.shouldSetChartAccessibilitySubtitle){t.setChartAccessibilitySubtitle();t.shouldSetChartAccessibilitySubtitle=false}if(t.shouldSetChartAccessibilityLongDescription){t.setChartAccessibilityLongDescription();t.shouldSetChartAccessibilityLongDescription=false}if(t.shouldSetChartAccessibilityExecutiveSummary){t.setChartAccessibilityExecutiveSummary();t.shouldSetChartAccessibilityExecutiveSummary=false}if(t.shouldSetChartAccessibilityPurpose){t.setChartAccessibilityPurpose();t.shouldSetChartAccessibilityPurpose=false}if(t.shouldSetChartAccessibilityContext){t.setChartAccessibilityContext();t.shouldSetChartAccessibilityContext=false}if(t.shouldSetChartAccessibilityStatisticalNotes){t.setChartAccessibilityStatisticalNotes();t.shouldSetChartAccessibilityStatisticalNotes=false}if(t.shouldSetChartAccessibilityStructureNotes){t.setChartAccessibilityStructureNotes();t.shouldSetChartAccessibilityStructureNotes=false}if(t.shouldSetParentSVGAccessibility){t.setParentSVGAccessibility();t.shouldSetParentSVGAccessibility=false}if(t.shouldUpdateDisplayDepth){t.updateDisplayDepth();t.shouldUpdateDisplayDepth=false}if(t.shouldZoom){var i=t.getZoomTarget();t.drawZoomChildren(i);t.zoom(i);t.shouldZoom=false}else if(t.shouldUpdateLabels){var i=t.getZoomTarget();if(i.children&&i.children.length){t.setLabelSelections(i.children)}t.shouldUpdateLabels=false}if(t.shouldAddStrokeUnder){t.addStrokeUnder();t.shouldAddStrokeUnder=false}if(t.shouldSetGeometryAccessibilityAttributes){t.setGeometryAccessibilityAttributes();t.shouldSetGeometryAccessibilityAttributes=false}if(t.shouldSetGeometryAriaLabels){t.setGeometryAriaLabels();t.shouldSetGeometryAriaLabels=false}if(t.shouldBindInteractivity){t.bindInteractivity();t.shouldBindInteractivity=false}if(t.shouldDrawInteractionState){t.updateInteractionState();t.shouldDrawInteractionState=false}if(t.shouldUpdateCursor){t.updateCursor();t.shouldUpdateCursor=false}if(t.shouldUpdateAnnotations){t.drawAnnotations();t.shouldUpdateAnnotations=false}t.onChangeHandler();e("component did update")})).then((function(){return t.drawEndEvent.emit({chartID:t.chartID})}))};t.prototype.shouldValidateAccessibilityProps=function(){if(this.shouldValidateAccessibility&&!this.accessibility.disableValidation){this.shouldValidateAccessibility=false;validateAccessibilityProps(this.chartID,Object.assign({},this.accessibility),{annotations:this.annotations,data:this.data,uniqueID:this.uniqueID,context:{mainTitle:this.mainTitle,onClickEvent:!this.suppressEvents?this.clickEvent.emit:undefined}})}};t.prototype.setTableData=function(){var t=scopeDataKeys(this,chartAccessors,"circle-packing");this.tableData=getScopedData(this.data,t);this.tableColumns=Object.keys(t)};t.prototype.setLayoutData=function(){this.padding=typeof this.padding==="string"?getPadding(this.padding):this.padding;this.innerHeight=this.height-this.margin.top-this.margin.bottom;this.innerWidth=this.width-this.margin.left-this.margin.right;this.innerPaddedHeight=this.innerHeight-this.padding.top-this.padding.bottom;this.innerPaddedWidth=this.innerWidth-this.padding.left-this.padding.right};t.prototype.restructureData=function(){var t=this;this.diameter=Math.min(this.innerPaddedWidth,this.innerPaddedHeight);this.holder=stratify().id((function(e){return e[t.nodeAccessor]})).parentId((function(e){return e[t.parentAccessor]}))(this.data);this.rootCircle=hierarchy(this.holder).sum((function(e){return e.data[t.sizeAccessor]||1})).sort((function(t,e){return e.data.value-t.data.value}));this.nodes=index().size([this.diameter-this.circlePadding,this.diameter-this.circlePadding]).padding(this.circlePadding)(this.rootCircle).descendants();this.innerDataDepth=this.dataDepth?Math.min(max(this.nodes,(function(t){return t.depth})),this.dataDepth):max(this.nodes,(function(t){return t.depth}));this.nodes=this.nodes.filter((function(e){return!(e.depth>t.innerDataDepth)}))};t.prototype.validateInteractionKeys=function(){this.innerInteractionKeys=!this.interactionKeys||this.interactionKeys&&this.interactionKeys.length===0?[this.nodeAccessor]:__spreadArray([],this.interactionKeys,true)};t.prototype.prepareChartForDrawing=function(){var t=this.zoomToNode?this.generateValidId(this.zoomToNode[this.nodeAccessor]):"";var e=this.zoomToNode?this.rootG.select("#circle-in-pack-"+t).data()[0]:this.rootCircle;this.view=!this.view?[e.x,e.y,e.r*2]:this.view;this.zoomRatio=!this.zoomRatio?this.diameter/this.view[2]:this.zoomRatio;this.currentDepth=e.depth};t.prototype.renderRootElements=function(){this.svg=select(this.circlePackingEl).select(".visa-viz-circle-packing-container").append("svg").attr("width",this.width).attr("height",this.height).attr("viewBox","0 0 "+this.width+" "+this.height).attr("data-testid","root-svg");this.root=this.svg.append("g").attr("id","visa-viz-margin-container-g-"+this.chartID).attr("data-testid","margin-container");this.rootG=this.root.append("g").attr("id","visa-viz-padding-container-g-"+this.chartID).attr("data-testid","padding-container");this.circleG=this.rootG.append("g").attr("class","circle-pack-group").attr("data-testid","circle-group");this.textG=this.rootG.append("g").attr("class","circle-pack-text-group").attr("data-testid","dataLabel-group");this.tooltipG=select(this.circlePackingEl).select(".circle-packing-tooltip")};t.prototype.reSetRoot=function(){var t=prepareRenderChange({selection:this.svg,duration:this.duration,namespace:"root_reset"});t.attr("width",this.width).attr("height",this.height).attr("viewBox","0 0 "+this.width+" "+this.height);var e=prepareRenderChange({selection:this.root,duration:this.duration,namespace:"root_reset"});e.attr("transform","translate(".concat(this.diameter/2+this.margin.left,", ").concat(this.diameter/2+this.margin.top,")"));var i=prepareRenderChange({selection:this.rootG,duration:this.duration,namespace:"root_reset"});i.attr("transform","translate(".concat(this.padding.left,", ").concat(this.padding.top,")"));if(typeof this.filter!=="undefined"){this.enterUpdateExitCircles(this.circleG,this.filterData(0))}setAccessibilityDescriptionWidth(this.chartID,this.width)};t.prototype.setGlobalSelections=function(){this.circle=this.rootG.selectAll("circle:not(.vcl-accessibility-focus-highlight)")};t.prototype.enterUpdateExitCircles=function(t,e){var i=e[0].depth;var s=t.selectAll(".g-level-"+i).data(e,(function(t){return t.data.id}));this.enterCircle=s.enter().append("g");this.enterSize+=this.enterCircle.size();this.exitCircle=s.exit();this.enterCircles(i);this.exitCircles(this.exitCircle,true);this.updateParentCircle=s.merge(this.enterCircle);this.updateParentCircle.order();this.checkRecursion(i)};t.prototype.enterCircles=function(t){var e=this;this.enterCircle.attr("class","g-level-"+t).attr("id",(function(t){return"circle-in-pack-"+e.generateValidId(t.data.id)}));this.enterCircle.append("circle").attr("filter",this.setCircleFilter).classed("node node-level-"+t,true).classed("node--root",(function(t,e,i){var s=select(i[e].parentNode).datum();return!s.parent})).on("mouseover",!this.suppressEvents?function(t,i,s){var a=select(s[i].parentNode).datum();e.onHoverHandler(a,s[i])}:null).on("mouseout",!this.suppressEvents?function(){e.onMouseOutHandler()}:null).on("click",!this.suppressEvents?function(t,i,s){var a=select(s[i].parentNode).datum();if(!e.zooming){e.clickEvent.emit({data:a.data.data,target:s[i]})}}:null).attr("fill",this.setCircleStyle).attr("opacity",(function(t,i,s){var a=select(s[i].parentNode).datum();var r=a.data.data;return checkInteraction(r,1,e.hoverOpacity,e.hoverHighlight,e.clickHighlight,e.innerInteractionKeys)})).each((function(t,i,s){initializeElementAccess(s[i]);setElementFocusHandler({node:s[i],geomType:"node",includeKeyNames:e.accessibility.includeDataKeyNames,dataKeys:scopeDataKeys(e,chartAccessors,"circle-packing"),recursive:true,groupName:"node",uniqueID:e.chartID});setElementAccessID({node:s[i],uniqueID:e.chartID});var a=select(s[i].parentNode).datum();var r=checkInteraction(a,true,false,"",e.clickHighlight,e.innerInteractionKeys);r=e.clickHighlight&&e.clickHighlight.length?r:false;var o=e.accessibility.elementsAreInterface;setElementInteractionAccessState(s[i],r,o)})).attr("data-testid","circle").attr("data-id",(function(t,i,s){var a=select(s[i].parentNode).datum();var r=a.data.data;return"circle-".concat(r[e.parentAccessor],"-").concat(r[e.nodeAccessor])})).attr("cursor",!this.suppressEvents?this.cursor:null).attr("transform",(function(t){return"translate("+roundTo((t.x-e.view[0])*e.zoomRatio,4)+","+roundTo((t.y-e.view[1])*e.zoomRatio,4)+")"})).attr("r",0)};t.prototype.exitCircles=function(t,e){if(t.size()){this.exitSize+=t.size();if(e){this.exitSize+=t.selectAll("g").size()}var i=checkAccessFocus(this.rootG.node());t.remove();this.setChartCountAccessibility();this.setGeometryAriaLabels();retainAccessFocus({parentGNode:this.rootG.node(),focusDidExist:i,recursive:true})}};t.prototype.checkRecursion=function(t){var e=this;this.updateParentCircle.each((function(i,s,a){var r=e.currentDepth+e.innerDisplayDepth;var o=0;if(i.depth+1<=r){o=t+1}if(o&&i.children&&i.children.length){e.enterUpdateExitCircles(select(a[s]),i.children)}else{e.exitCircles(select(a[s]).selectAll("g"),false)}}))};t.prototype.setLabelSelections=function(t){var e=this.textG.selectAll("text").data(t,(function(t){return(t.data||{}).id}));this.enterText=e.enter().append("text");this.updateText=e.merge(this.enterText);this.exitText=e.exit().remove();this.enterLabels();this.drawLabels()};t.prototype.enterLabels=function(){var t=this;this.enterText.attr("filter",this.textFilter).attr("class","label circle-packing-dataLabel").attr("cursor",!this.suppressEvents?this.cursor:null).attr("data-testid","dataLabel").attr("data-x",(function(e){return roundTo((e.x-t.view[0])*t.zoomRatio,4)})).attr("data-y",(function(e){return roundTo((e.y-t.view[1])*t.zoomRatio,4)})).attr("data-translate-x",this.diameter/2+this.margin.left).attr("data-translate-y",this.diameter/2+this.margin.top).attr("x",(function(e){return roundTo((e.x-t.view[0])*t.zoomRatio,4)})).attr("y",(function(e){return roundTo((e.y-t.view[1])*t.zoomRatio,4)})).attr("text-anchor","middle")};t.prototype.drawLabels=function(){var t=this;this.updateText.attr("opacity",(function(e){return t.dataLabel.visible?1:0})).text((function(e){return t.dataLabel.labelAccessor?e.data.data[t.dataLabel.labelAccessor]:e.data.data[t.nodeAccessor]}));if(!this.shouldZoom&&this.shouldUpdateLabels)this.placeLabels()};t.prototype.placeLabels=function(){var t=this;var e=this.dataLabel.placement!=="auto"&&this.dataLabel.collisionHideOnly;var i=this.updateText.classed("moving",(function(e,i,s){var a=+select(s[i]).attr("data-x");var r=+select(s[i]).attr("data-y");var o=roundTo((e.x-t.view[0])*t.zoomRatio,4);var n=roundTo((e.y-t.view[1])*t.zoomRatio,4);return a!==o||r!==n})).attr("data-x",(function(e){return roundTo((e.x-t.view[0])*t.zoomRatio,4)})).attr("data-y",(function(e){return roundTo((e.y-t.view[1])*t.zoomRatio,4)})).attr("data-translate-x",this.diameter/2+this.margin.left).attr("data-translate-y",this.diameter/2+this.margin.top).style("visibility",(function(e,i,s){return t.dataLabel.placement==="auto"||t.dataLabel.collisionHideOnly?select(s[i]).style("visibility"):null})).attr("filter",null).transition("place").duration(this.duration);var s={all:{validPositions:["middle","top","bottom","left","right","bottom-right","bottom-left","top-left","top-right"],offsets:[1,1,2,4,4,1,1,1,1]},centroid:{validPositions:["middle"],offsets:[1]},top:{validPositions:["top","top-left","top-right"],offsets:[1,1,1]},middle:{validPositions:["middle","left","right"],offsets:[1,4,4]},bottom:{validPositions:["bottom","bottom-left","bottom-right"],offsets:[2,1,1]},right:{validPositions:["right","top-right","bottom-right"],offsets:[4,1,1]},left:{validPositions:["left","top-left","bottom-left"],offsets:[4,1,1]}};var a=this.dataLabel&&this.dataLabel.collisionPlacement;var r=e?["middle"]:a&&s[a]?s[a].validPositions:s["all"].validPositions;var o=e?[1]:a&&s[a]?s[a].offsets:s["all"].offsets;if(this.dataLabel.visible&&(this.dataLabel.placement==="auto"||this.dataLabel.collisionHideOnly)){this.bitmaps=resolveLabelCollision({labelSelection:i,avoidMarks:[],validPositions:r,offsets:o,accessors:[this.parentAccessor,this.nodeAccessor],size:[roundTo(this.innerPaddedWidth),roundTo(this.innerPaddedHeight)],hideOnly:this.dataLabel.visible&&e});if(e){i.attr("x",(function(e){return roundTo((e.x-t.view[0])*t.zoomRatio,4)})).attr("y",(function(e){return roundTo((e.y-t.view[1])*t.zoomRatio,4)}))}}else{i.attr("x",(function(e){return roundTo((e.x-t.view[0])*t.zoomRatio,4)})).attr("y",(function(e){return roundTo((e.y-t.view[1])*t.zoomRatio,4)}))}i.call(transitionEndAll,(function(){t.updateText.classed("moving",false);setTimeout((function(){t.addStrokeUnder()}),0)}))};t.prototype.addStrokeUnder=function(){this.updateText.attr("filter",this.textFilter)};t.prototype.setTextStrokes=function(){this.textFilter=createTextStrokeFilter({root:this.svg.node(),id:this.chartID,color:"#ffffff"});this.filter=createTextStrokeFilter({root:this.svg.node(),id:this.chartID,color:"#ffffff",strokeSizeOverride:1})};t.prototype.bindInteractivity=function(){var t=this;this.circle.on("mouseover",!this.suppressEvents?function(e,i,s){var a=select(s[i].parentNode).datum();t.onHoverHandler(a,s[i])}:null).on("mouseout",!this.suppressEvents?function(){t.onMouseOutHandler()}:null).on("click",!this.suppressEvents?function(e,i,s){var a=select(s[i].parentNode).datum();if(!t.zooming){t.clickEvent.emit({data:a.data.data,target:s[i]})}}:null)};t.prototype.drawAnnotations=function(){annotate({source:this.rootG.node(),data:this.annotations,width:this.width,height:this.height,padding:this.padding,margin:this.margin,bitmaps:this.bitmaps});setAccessAnnotation(this.circlePackingEl,this.annotations)};t.prototype.setColors=function(){this.preparedColors=this.colors?convertVisaColor(this.colors):getColors(this.colorPalette,this.innerDataDepth+1)};t.prototype.setTextures=function(){var t=this.preparedColors.range?this.preparedColors.range():this.preparedColors;if(this.accessibility.hideTextures||t.length>6){this.colorArr=this.preparedColors}else{var e=convertColorsToTextures({colors:t,rootSVG:this.svg.node(),id:this.chartID,scheme:"categorical",disableTransitions:!this.duration});this.colorArr=this.preparedColors.range?this.preparedColors.copy().range(e):e}};t.prototype.setStrokes=function(){var t=this;this.strokes=[];this.preparedColors.forEach((function(e){t.strokes.push(getContrastingStroke(e))}))};t.prototype.updateDisplayDepth=function(){var t=this;this.innerDisplayDepth=this.displayDepth?Math.min(max(this.nodes,(function(t){return t.depth})),this.displayDepth):max(this.nodes,(function(t){return t.depth}));if(this.circleG){this.circleG.selectAll("g").each((function(e,i,s){if(e.depth>t.innerDisplayDepth){t.exitSize++;t.exitSize+=select(s[i]).selectAll("g").size();select(s[i]).remove()}}))}};t.prototype.updateCursor=function(){this.circle.attr("cursor",!this.suppressEvents?this.cursor:null)};t.prototype.updateInteractionState=function(){var t=this;this.circle.attr("fill",this.setCircleStyle).attr("filter",this.setCircleFilter).attr("opacity",(function(e,i,s){var a=select(s[i].parentNode).datum();var r=a.data.data;return checkInteraction(r,1,t.hoverOpacity,t.hoverHighlight,t.clickHighlight,t.innerInteractionKeys)})).each((function(e,i,s){var a=select(s[i].parentNode).datum();var r=checkInteraction(a,true,false,"",t.clickHighlight,t.innerInteractionKeys);r=t.clickHighlight&&t.clickHighlight.length?r:false;var o=t.accessibility.elementsAreInterface;setElementInteractionAccessState(s[i],r,o)}));if(!this.zooming){retainAccessFocus({parentGNode:this.rootG.node(),recursive:true})}};t.prototype.drawZoomChildren=function(t){if(t.children&&t.children.length){var e=this.generateValidId(t.data.id);this.enterUpdateExitCircles(this.rootG.select("#circle-in-pack-"+e),t.children);this.setGlobalSelections();this.setLabelSelections(t.children)}else if(t){this.setGlobalSelections();this.setLabelSelections([t])}};t.prototype.getZoomTarget=function(){var t=this.zoomToNode?this.generateValidId(this.zoomToNode[this.nodeAccessor]):"";return this.zoomToNode?this.rootG.select("#circle-in-pack-"+t).datum():this.rootCircle};t.prototype.zoom=function(t){var e=this;this.zooming=true;this.view=[t.x,t.y,t.r*2];this.zoomRatio=this.diameter/this.view[2];this.circle.classed("moving",(function(t,i,s){var a=select(s[i].parentNode).datum();var r=+select(s[i]).attr("data-cx");var o=+select(s[i]).attr("data-cy");var n=+select(s[i]).attr("r");var l=roundTo((a.x-e.view[0])*e.zoomRatio,4);var c=roundTo((a.y-e.view[1])*e.zoomRatio,4);var h=a.r*e.zoomRatio;return n!==h||r!==l||o!==c})).attr("data-cx",(function(t,i,s){var a=select(s[i].parentNode).datum();return roundTo((a.x-e.view[0])*e.zoomRatio,4)})).attr("data-cy",(function(t,i,s){var a=select(s[i].parentNode).datum();return roundTo((a.y-e.view[1])*e.zoomRatio,4)})).attr("data-r",(function(t,i,s){var a=select(s[i].parentNode).datum();return a.r*e.zoomRatio})).attr("data-translate-x",this.diameter/2+this.margin.left).attr("data-translate-y",this.diameter/2+this.margin.top);var i=this.circle.filter(".moving").attr("filter",null).transition("zoom").duration(this.duration).attr("transform",(function(t,i,s){var a=select(s[i].parentNode).datum();return"translate("+roundTo((a.x-e.view[0])*e.zoomRatio,4)+","+roundTo((a.y-e.view[1])*e.zoomRatio,4)+")"})).attr("r",(function(t,i,s){var a=select(s[i].parentNode).datum();return a.r*e.zoomRatio}));var s=function(){e.zooming=false;e.circle.classed("moving",false);setTimeout((function(){e.circle.attr("filter",e.setCircleFilter)}),0);retainAccessFocus({parentGNode:e.rootG.node(),recursive:true});e.transitionEndEvent.emit({chartID:e.chartID})};if(this.duration&&i.size()>0){i.attrTween("x",(function(t,i,s){var a=select(s[i]).classed("vcl-accessibility-focus-source");return function(){if(a){retainAccessFocus({parentGNode:e.rootG.node(),recursive:true})}return 0}})).call(transitionEndAll,s)}else{s()}this.placeLabels()};t.prototype.onHoverHandler=function(t,e){overrideTitleTooltip(this.chartID,true);this.hoverEvent.emit({data:t.data.data,target:e});if(this.showTooltip){this.eventsTooltip({data:t.data.data,evt:event,isToShow:true})}};t.prototype.onMouseOutHandler=function(){overrideTitleTooltip(this.chartID,false);this.mouseOutEvent.emit();if(this.showTooltip){this.eventsTooltip({isToShow:false})}};t.prototype.setTooltipInitialStyle=function(){initTooltipStyle(this.tooltipG)};t.prototype.eventsTooltip=function(t){var e=t.data,i=t.evt,s=t.isToShow;drawTooltip({root:this.tooltipG,data:e,event:i,isToShow:s,tooltipLabel:this.tooltipLabel,dataLabel:this.dataLabel,ordinalAccessor:this.nodeAccessor,groupAccessor:this.parentAccessor,valueAccessor:this.sizeAccessor,chartType:"circle-packing"})};t.prototype.setTagLevels=function(){this.topLevel=findTagLevel(this.highestHeadingLevel);this.bottomLevel=findTagLevel(this.highestHeadingLevel,3)};t.prototype.setChartDescriptionWrapper=function(){initializeDescriptionRoot({rootEle:this.circlePackingEl,title:this.accessibility.title||this.mainTitle,chartTag:"circle-packing",uniqueID:this.chartID,recursive:true,redraw:this.shouldRedrawWrapper,disableKeyNav:this.suppressEvents&&this.accessibility.elementsAreInterface===false&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled});this.shouldRedrawWrapper=false};t.prototype.setParentSVGAccessibility=function(){setAccessibilityController({node:this.svg.node(),chartTag:"circle-packing",title:this.accessibility.title||this.mainTitle,description:this.subTitle,uniqueID:this.chartID,geomType:"node",includeKeyNames:this.accessibility.includeDataKeyNames,dataKeys:scopeDataKeys(this,chartAccessors,"circle-packing"),groupAccessor:this.parentAccessor,groupName:"node",recursive:true,disableKeyNav:this.suppressEvents&&this.accessibility.elementsAreInterface===false&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled})};t.prototype.setGeometryAccessibilityAttributes=function(){this.rootG.selectAll(".node").each((function(t,e,i){initializeElementAccess(i[e])}))};t.prototype.setGeometryAriaLabels=function(){var t=this;var e=scopeDataKeys(this,chartAccessors,"circle-packing");this.rootG.selectAll(".node").each((function(i,s,a){setElementFocusHandler({node:a[s],geomType:"node",includeKeyNames:t.accessibility.includeDataKeyNames,dataKeys:e,recursive:true,groupName:"node",uniqueID:t.chartID,disableKeyNav:t.suppressEvents&&t.accessibility.elementsAreInterface===false&&t.accessibility.keyboardNavConfig&&t.accessibility.keyboardNavConfig.disabled});setElementAccessID({node:a[s],uniqueID:t.chartID})}))};t.prototype.setChartAccessibilityTitle=function(){setAccessTitle(this.circlePackingEl,this.accessibility.title||this.mainTitle)};t.prototype.setChartAccessibilitySubtitle=function(){setAccessSubtitle(this.circlePackingEl,this.subTitle)};t.prototype.setChartAccessibilityLongDescription=function(){setAccessLongDescription(this.circlePackingEl,this.accessibility.longDescription)};t.prototype.setChartAccessibilityExecutiveSummary=function(){setAccessExecutiveSummary(this.circlePackingEl,this.accessibility.executiveSummary)};t.prototype.setChartAccessibilityPurpose=function(){setAccessPurpose(this.circlePackingEl,this.accessibility.purpose)};t.prototype.setChartAccessibilityContext=function(){setAccessContext(this.circlePackingEl,this.accessibility.contextExplanation)};t.prototype.setChartAccessibilityStatisticalNotes=function(){setAccessStatistics(this.circlePackingEl,this.accessibility.statisticalNotes)};t.prototype.setChartCountAccessibility=function(){setAccessChartCounts({rootEle:this.circlePackingEl,parentGNode:this.circleG.node(),chartTag:"circle-packing",geomType:"node",groupName:"node",recursive:true})};t.prototype.setChartAccessibilityStructureNotes=function(){setAccessStructure(this.circlePackingEl,this.accessibility.structureNotes)};t.prototype.onChangeHandler=function(){if(this.accessibility&&typeof this.accessibility.onChangeFunc==="function"){var t={updated:this.updated,added:this.enterSize,removed:this.exitSize};this.accessibility.onChangeFunc(t)}this.updated=false;this.enterSize=0;this.exitSize=0};t.prototype.filterData=function(t){return this.nodes.filter((function(e){if(e.depth===t){return true}return false}))};t.prototype.render=function(){this.drawStartEvent.emit({chartID:this.chartID});this.init();if(this.shouldSetTagLevels){this.setTagLevels();this.shouldSetTagLevels=false}if(this.shouldValidateInteractionKeys){this.validateInteractionKeys();this.shouldValidateInteractionKeys=false}if(this.shouldUpdateTableData){this.setTableData();this.shouldUpdateTableData=false}if(this.shouldValidate){this.shouldValidateAccessibilityProps();this.shouldValidate=false}if(this.shouldUpdateLayout){this.setLayoutData();this.shouldUpdateLayout=false}if(this.shouldUpdateData){this.restructureData();this.shouldUpdateData=false}return h("div",{class:"o-layout","data-testid":"outer-layout"},h("div",{class:"o-layout--chart","data-testid":"layout-chart"},h(this.topLevel,{"data-testid":"main-title"},this.mainTitle),h(this.bottomLevel,{class:"visa-ui-text--instructions","data-testid":"sub-title"},this.subTitle),h("keyboard-instructions",{uniqueID:this.chartID,geomType:"node",groupName:"node collection",chartTag:"circle-packing",width:this.width-(this.margin?this.margin.right||0:0),isInteractive:this.accessibility.elementsAreInterface,hasCousinNavigation:true,cousinResultOverride:"Drill up or down a level",disabled:this.suppressEvents&&this.accessibility.elementsAreInterface===false&&this.accessibility.keyboardNavConfig&&this.accessibility.keyboardNavConfig.disabled}),h("div",{class:"visa-viz-circle-packing-container","data-testid":"chart-container"}),h("div",{class:"circle-packing-tooltip vcl-tooltip","data-testid":"tooltip-container",style:{display:this.showTooltip?"block":"none"}}),h("data-table",{uniqueID:this.chartID,isCompact:true,tableColumns:this.tableColumns,data:this.tableData,padding:this.padding,margin:this.margin,hideDataTable:this.accessibility.hideDataTableButton})))};t.prototype.init=function(){var t=Object.keys(CirclePackingDefaultValues);var e=0;var i={showTooltip:{exception:false},circlePadding:{exception:0},mainTitle:{exception:""},subTitle:{exception:""},hoverOpacity:{exception:0}};for(e=0;e<t.length;e++){var s=!i[t[e]]?false:this[t[e]]===i[t[e]].exception;if(!(this[t[e]]||s)&&!(CirclePackingDefaultValues[t[e]]===this[t[e]])){this[t[e]]=CirclePackingDefaultValues[t[e]]}}};Object.defineProperty(t.prototype,"circlePackingEl",{get:function(){return getElement(this)},enumerable:false,configurable:true});Object.defineProperty(t,"watchers",{get:function(){return{data:["dataWatcher"],mainTitle:["titleWatcher"],subTitle:["subtitleWatcher"],highestHeadingLevel:["headingWatcher"],parentAccessor:["clusterWatcher"],nodeAccessor:["nodeWatcher"],sizeAccessor:["sizeWatcher"],height:["heightWatcher"],width:["heightWatcher"],padding:["heightWatcher"],margin:["heightWatcher"],dataDepth:["dataDepthWatcher"],displayDepth:["displayDepthWatcher"],circlePadding:["circlePaddingWatcher"],colors:["colorsWatcher"],colorPalette:["colorsWatcher"],showTooltip:["showTooltipWatcher"],tooltipLabel:["tooltipLabelWatcher"],hoverOpacity:["hoverOpacityWatcher"],clickStyle:["interactionStyleWatcher"],hoverStyle:["interactionStyleWatcher"],cursor:["cursorWatcher"],clickHighlight:["clickWatcher"],hoverHighlight:["hoverWatcher"],zoomToNode:["zoomWatcher"],interactionKeys:["interactionWatcher"],dataLabel:["labelWatcher"],accessibility:["accessibilityWatcher"],annotations:["annotationsWatcher"],uniqueID:["idWatcher"],suppressEvents:["suppressWatcher"]}},enumerable:false,configurable:true});return t}();window["VisaChartsLibOSSLicenses"]=getLicenses();CirclePacking.style=circlePackingCss;export{CirclePacking as circle_packing};